<head>
        <!-- Plotly.js -->
                <!-- <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> -->
                <script src="../js/plotly-latest.min.js" ></script>
                </head>
                <body>
                <!-- Plotly chart will be drawn inside this DIV -->
                <div id="myDiv-CO2" style="width:100%;height:100%"></div>
                
</body>
<script src="../js/jquery.min.js"></script>
<script src="../js/Chart.min.js"></script>
<script src="../js/moments.js"></script>
                <script>
                    /*
                Plotly.d3.csv('https://raw.githubusercontent.com/plotly/datasets/master/3d-scatter.csv', function(err, rows){
      function unpack(rows, key) {
          return rows.map(function(row) 
          { return row[key]; });
      }
var trace1 = {
  x:unpack(rows, 'x1'),  y: unpack(rows, 'y1'), z: unpack(rows, 'z1'), 
  mode: 'markers',
  marker: {
    size: 12,
    line: {
      color: 'rgba(217, 217, 217, 0.14)',
      width: 0.5
    },
    opacity: 0.8
  },
  type: 'scatter3d'
};
var trace2 = {
  x:unpack(rows, 'x2'),  y: unpack(rows, 'y2'), z: unpack(rows, 'z2'), 
  mode: 'markers',
  marker: {
    color: 'rgb(127, 127, 127)',
    size: 12,
    symbol: 'circle',
    line: {
      color: 'rgb(204, 204, 204)',
      width: 1
    },
    opacity: 0.9
  },
  type: 'scatter3d'
};
var data = [trace1, trace2];
var layout = {
      dragmode: false,
      margin: {
        l: 0,
        r: 0,
        b: 0,
        t: 0
  }};
Plotly.newPlot('myDiv', data, layout);
});*/
                </script>

               
        
                

                <script>


                        var url = "http://localhost/engineering_bdst/";
                        
                        
                        loadChart('CO2', 'allschool');
                        
                       // loadChart('Temperature', 'allschool');
                        
                        
                        function loadChart(graph_type,filter_type){
                            
                            var json_url;
                              $.ajax({
                                  url : url + "/graph_php_files/graph_hub_sql.php",
                                  type : "GET",
                                  success : function(data){
                                      //console.log(data);
                        
                                      //The potential Graph Types
                        
                                      var elementary_location_array = [//Elementary
                                        'E101B', 'E103', 'E104', 'E105', 'E106',
                                                    'E107', 'ef1stair', 'E111', 'E121', 'E117',
                                                    'E115', 'E114', 'E113', 'E108', 'E109', 'esf1hallway', 'E122',
                                
                                                    'esf2stairs', 'E207', 'E206', 'E205', 'E204',
                                                    'E203', 'E202', 'E201', 'E209' ,'E208', 'E221',
                                                    'E216', 'E215', 'E214', 'E213', 'E220', 'esf2hall',
                                
                                                    'esf3stairs', 'E307', 'E306', 'E305', 'E304',
                                                    'E303', 'E302', 'E301', 'E309', 'E308', 'E321',
                                                    'E316', 'E315', 'E314', 'E313', 'E320', 'E311',
                                                    'E322', 'E310',
                                
                                                    'esf4stairs', 'E407', 'E406', 'E405', 'E404', 'E403',
                                                    'E402', 'E401', 'E409', 'E408', 'E421', 'E416', 'E415',
                                                    'E414', 'E413', 'E422', 'E410', 'esf4hall', 'esf3hall'];
                        
                                      var intermediate_location_array = [
                                        //Intermediate Building
                                        'M110', 'M111', 'M115' ,'Intermediate_hallway',
                                                    'M109', 'M108', 'M102', 'M104', 'M105', 'M106',
                                                    'M107', 'M101A', 'M101', 'M101B', 'M101C',
                                                    'M101D', 'M124','M123A', 'M123B', 'M123C',
                                                    'M121B', 'M121A', 'M121', 'M123', 'M119', 'M117',
                                                    'M120', 'M116', 'M122', 'M124A',
                                
                                                    'intermediate_f2_hallways', 'M211', 'M210', 'M209', 'M208', 'M207', 'M206',
                                                    'M205', 'M204', 'M202', 'M201', 'M225', 'M224',
                                                    'M223', 'M216', 'M219', 'M220', 'M217'];
                        
                                      var highschool_location_array = ['H036', 'H034', 'H032', 'H030', 'H026', 'H020', 'H018',
                                                    'H015B', 'H015A', 'H108', 'H107', 'H006', 'H005', 'H004',
                                                    'H003', 'H041', 'H040', 'H015', 'L1stair',
                                
                                                    'H127', 'H117', 'F1stairs', 'f1hall', 'H105', 'H104', 'H103',
                                                    'H102', 'H115', 'H115A', 'H116', 'H118', 'H116A', 'f1stair2',
                                                    'welcomecenter',
                                
                                                    'H227', 'H227C', 'H227A', 'H227B','H229', 'H230', 'H231', 'H232',
                                                    'H233', 'H234', 'H235', 'H236', 'H237', 'H240', 'H216', 'H218', 'H218C',
                                                    'H218A', 'pclounge', 'pccafe', 'H206', 'H205', 'H204', 'H203', 'H201',
                                
                                                    'marketing', 'H301','H306', 'H305', 'H304', 'H303', 'H318', 'f3hall1', 'f3hall2',
                                
                                                    'H405', 'H404', 'H403', 'H401', 'f4hallA', 'f4hallB', 'f4hallC',
                                                    'H429', 'H418', 'H416', 'H417', 'H429A',
                                
                                                    'H506', 'H505', 'H504', 'H503', 'H501', 'f5HallC', 'f5HallA',
                                                    'f5HallB', 'H529', 'H518', 'H518A', 'H516', 'H517',
                                
                                                    'f6hallB', 'H606', 'H605', 'H604', 'H603', 'f6hallA', 'H601'];
                        
                                      var pc_location_array = ['PC_entrance', 'PC_commons',
                                          'P106', 'stairs','P103', 'P107',
                                          'P108', 'P111', 'P113b', 'P113a',
                                          'P116', 'P117', 'P121', 'P128',
                                          'P132', 'P133', 'P134', 'P135',
                                          'P137', 'P138',
                                
                                          'P235', 'P234', 'P233' , 'P232', 'P230', 'P201', 'P202A',
                                          'P202', 'P203', 'P204', 'PChallA', 'PCstairs', 'PCoverhead',
                                           'P207', 'H208', 'P209', 'P211',
                                          'PCac'];
                        
                                      var rittman_location_array = ['R101', 'R102', 'R110', 'R103', 'lobby_hallway', 'R104',
                                                    'R105', 'R107', 'R106', 'R108', 'R109', 'f2_hallway',
                                                    'R220', 'R221', 'practice_rooms', 'R228', 'R229',
                                                    'f3_hallway', 'R302', 'R301', 'R303', 'R305', 'R306',
                                                    'R307', 'R308', 'R401', 'R402', 'R403', 'R407', 'R404',
                                                    'R405', 'R406', 'roof_garden', 'f4_hallway'];
                        
                                      var all_school_array = [
                                        //Elementary
                                        'E101B', 'E103', 'E104', 'E105', 'E106',
                                                    'E107', 'ef1stair', 'E111', 'E121', 'E117',
                                                    'E115', 'E114', 'E113', 'E108', 'E109', 'esf1hallway', 'E122',
                                
                                                    'esf2stairs', 'E207', 'E206', 'E205', 'E204',
                                                    'E203', 'E202', 'E201', 'E209' ,'E208', 'E221',
                                                    'E216', 'E215', 'E214', 'E213', 'E220', 'esf2hall',
                                
                                                    'esf3stairs', 'E307', 'E306', 'E305', 'E304',
                                                    'E303', 'E302', 'E301', 'E309', 'E308', 'E321',
                                                    'E316', 'E315', 'E314', 'E313', 'E320', 'E311',
                                                    'E322', 'E310',
                                
                                                    'esf4stairs', 'E407', 'E406', 'E405', 'E404', 'E403',
                                                    'E402', 'E401', 'E409', 'E408', 'E421', 'E416', 'E415',
                                                    'E414', 'E413', 'E422', 'E410', 'esf4hall', 'esf3hall',
                                
                                        //Intermediate Building
                                
                                        'M110', 'M111', 'M115' ,'Intermediate_hallway',
                                                    'M109', 'M108', 'M102', 'M104', 'M105', 'M106',
                                                    'M107', 'M101A', 'M101', 'M101B', 'M101C',
                                                    'M101D', 'M124','M123A', 'M123B', 'M123C',
                                                    'M121B', 'M121A', 'M121', 'M123', 'M119', 'M117',
                                                    'M120', 'M116', 'M122', 'M124A',
                                
                                                    'intermediate_f2_hallways', 'M211', 'M210', 'M209', 'M208', 'M207', 'M206',
                                                    'M205', 'M204', 'M202', 'M201', 'M225', 'M224',
                                                    'M223', 'M216', 'M219', 'M220', 'M217',
                                
                                        //Highschool
                                                 'H036', 'H034', 'H032', 'H030', 'H026', 'H020', 'H018',
                                                    'H015B', 'H015A', 'H108', 'H107', 'H006', 'H005', 'H004',
                                                    'H003', 'H041', 'H040', 'H015', 'L1stair',
                                
                                                    'H127', 'H117', 'F1stairs', 'f1hall', 'H105', 'H104', 'H103',
                                                    'H102', 'H115', 'H115A', 'H116', 'H118', 'H116A', 'f1stair2',
                                                    'welcomecenter',
                                
                                                    'H227', 'H227C', 'H227A', 'H227B','H229', 'H230', 'H231', 'H232',
                                                    'H233', 'H234', 'H235', 'H236', 'H237', 'H240', 'H216', 'H218', 'H218C',
                                                    'H218A', 'pclounge', 'pccafe', 'H206', 'H205', 'H204', 'H203', 'H201',
                                
                                                    'marketing', 'H301','H306', 'H305', 'H304', 'H303', 'H318', 'f3hall1', 'f3hall2',
                                
                                                    'H405', 'H404', 'H403', 'H401', 'f4hallA', 'f4hallB', 'f4hallC',
                                                    'H429', 'H418', 'H416', 'H417', 'H429A',
                                
                                                    'H506', 'H505', 'H504', 'H503', 'H501', 'f5HallC', 'f5HallA',
                                                    'f5HallB', 'H529', 'H518', 'H518A', 'H516', 'H517',
                                
                                                    'f6hallB', 'H606', 'H605', 'H604', 'H603', 'f6hallA', 'H601',
                                
                                        //PC Building
                                                    'PC_entrance', 'PC_commons',
                                          'P106', 'stairs','P103', 'P107',
                                          'P108', 'P111', 'P113b', 'P113a',
                                          'P116', 'P117', 'P121', 'P128',
                                          'P132', 'P133', 'P134', 'P135',
                                          'P137', 'P138',
                                
                                          'P235', 'P234', 'P233' , 'P232', 'P230', 'P201', 'P202A',
                                          'P202', 'P203', 'P204', 'PChallA', 'PCstairs', 'PCoverhead',
                                           'P207', 'H208', 'P209', 'P211',
                                          'PCac',
                                
                                        //Rittman
                                
                                        'R101', 'R102', 'R110', 'R103', 'lobby_hallway', 'R104',
                                                    'R105', 'R107', 'R106', 'R108', 'R109', 'f2_hallway',
                                                    'R220', 'R221', 'practice_rooms', 'R228', 'R229',
                                                    'f3_hallway', 'R302', 'R301', 'R303', 'R305', 'R306',
                                                    'R307', 'R308', 'R401', 'R402', 'R403', 'R407', 'R404',
                                                    'R405', 'R406', 'roof_garden', 'f4_hallway'
                                
                                                         ];
                                
                                
                                                         
                                //copied function from stack overflow on how to return an array with the matches
                                //of the two given arrays...
                                function getMatch(a, b) {
                                  var matches = [];
                        
                                  for ( var i = 0; i < a.length; i++ ) {
                                      for ( var e = 0; e < b.length; e++ ) {
                                          if ( a[i] === b[e] ) matches.push( a[i] );
                                      }
                                  }
                                  return matches;
                              }
                               //Distinct Location
                               var distinctLocationsRaw = [...new Set(data.map(x => x.Location))];
                              // console.log(distinctLocationsRaw);
                        
                              if(filter_type == "highschool"){
                                dataKeys = highschool_location_array;
                              } else if(filter_type == "PC"){
                                dataKeys = pc_location_array;
                              } else if(filter_type == "intermediate"){
                                dataKeys = intermediate_location_array;
                              } else if(filter_type == "rittman"){
                                dataKeys = rittman_location_array;
                              } else if(filter_type == "elementary"){
                                dataKeys = elementary_location_array;
                              } else if(filter_type == "allschool"){
                                dataKeys = all_school_array;
                              } else if(filter_type == "alldata"){
                                dataKeys = distinctLocationsRaw;
                              } else {
                                dataKeys = distinctLocationsRaw;
                                console.log("no filter type specified");
                              }

                              var colors = ['red', 'blue', 'green', 'magenta', 'lightblue', 'purple', 'orange', 'blueViolet',
    'brown', 'crimson', 'cyan', 'DarkGreen', 'SlateBlue', 'Navy', 'Grey', 'Olive', 'Lime', 'Teal',
    'Fuchsia', 'Silver', 	'RGB(240, 128, 128)', 'RGB(88, 214, 141)', 'RGB(231, 76, 60)', 'RGB(39, 55, 70)',
    'RGB(244, 208, 63)', 'RGB(174, 214, 241)', 'RGB(255, 87, 51)', 'RGB(211, 51, 80)']
                        
                        
                        
                              var distinctLocations = getMatch(distinctLocationsRaw, dataKeys);
                        
                        
                                var distinctLocationsLength = distinctLocations.length;
                                //console.log(distinctLocationsLength); //should print out 55 or something
                        
                                var large_room_data = [];
                        
                                for (var i = 0; i < distinctLocationsLength; i++){
                        
                                  var room_data = {
                                    y : [],
                                    mode: 'markers',
                                    name : distinctLocations[i], 
  marker: {
    size: 12,
    line: {
      color: colors[i],
      width: 0.5
    },
    opacity: 0.8
  },
  type: 'box',
                                  };
                        
                                            var len = data.length;
                                            for (var j = 0; j < len; j++) {
                                                if (data[j].Location == distinctLocations[i]) {
                                          //incrementing
                        
                                          if(graph_type == "CO2"){
                        
                                              room_data.y.push(data[j].CO2);
                                             
                        
                                          } else if (graph_type == "PM25"){
                        
                                              room_data.y.push(data[j].PM25);
                        
                                          } else if (graph_type == "Temperature") {
                        
                                              room_data.y.push(data[j].Temperature);
                        
                                          } else if (graph_type == "Humidity") {
                        
                                              room_data.y.push(data[j].Humidity);
                        
                                          } else if (graph_type == "VOC") {
                        
                                            room_data.y.push(data[j].VOC);
                        
                                        } else {
                                              console.log("Invalid Graph Creation");
                                          }
                        
                                          //incrementing
                                        //   room_data.x.push(moment().format(data[j].datetime));
                                                }
                                            }
                          //push into the larger array
                                    large_room_data.push(room_data);
                        
                                }
                          //Now i should have an array with number of rooms (so 3 right now)
                          //and then within each array there is Temperature and datetime
                          //name of each unit has to be designated by order
                          //console.log(large_room_data);

                          
                        
                          Plotly.newPlot('myDiv-' + graph_type, large_room_data);
                        
                                  },
                                  error : function(data) {
                                      //console.log(data);
                                  }
                        
                        
                              });
                          }
                        </script>
                        
                        
                        </html>
                        
                        
                          
                                